/****************************************************************************************************************************************************************
 *   Grunt File Usage:
 ****************************************************************************************************************************************************************
 *
 *  Export Documentation, TypeScript and Minify:
 *
 *      grunt
 *
 *  Export TypeScript and Minify:
 *
 *      grunt lib
 *
 *****************************************************************************************************************************************************************
 *  Options
 *****************************************************************************************************************************************************************
 *
 *  Export lib version, defaults to 'next' if not specified:
 *
 *      grunt --libversion=0.0.1
 *
 ****************************************************************************************************************************************************************
 *    Installing Dependencies:
 ****************************************************************************************************************************************************************
 *
 *  To install Grunt
 *
 *  1) install the grunt cli:
 *
 *      npm install -g grunt-cli
 *
 *  2) install the dependencies used by the build script:
 *
 *      OSX :       sudo npm install
 *      Windows:    npm install
 *
 ****************************************************************************************************************************************************************/

module.exports = function(grunt) {


    var version = grunt.option('libversion') || 'next';                     // Check for a version number | defaults to next if not specified

    //--------------------------------------------------------------------------------------------------------------
    // Plugins used by Grunt Script
    //--------------------------------------------------------------------------------------------------------------

	grunt.loadNpmTasks("grunt-ts");
    grunt.loadNpmTasks('grunt-contrib-uglify');    
	grunt.loadNpmTasks('grunt-contrib-watch');

    //--------------------------------------------------------------------------------------------------------------
    // Grunt Config
    //--------------------------------------------------------------------------------------------------------------

    grunt.initConfig( {

        //--------------------------------------------------------------------------------------------------------------
        // Read the package.json
        //--------------------------------------------------------------------------------------------------------------

        pkg: grunt.file.readJSON('package.json'),

        //--------------------------------------------------------------------------------------------------------------
        // Export and compile TypeScript
        //--------------------------------------------------------------------------------------------------------------

        ts: {

			Index: {
				src: ['src/index.ts'],
				out: 'bin/assets/js/index.js',
				options: {
					target: 'es5',
					sourcemap: true,
					declaration: false,
					comments: true
				}
			}
        },

        watch:{
            files:'src/*.ts',
            tasks:['ts:Index']
        },

        uglify: {
            dist: {
                files: {
                    // 出力ファイル: 元ファイル
                    'bin/assets/js/index-min.js': 'bin/assets/js/index.js'
                }
            }
        },

    } );

    //--------------------------------------------------------------------------------------------------------------
    // Register Grunt tasks
    //--------------------------------------------------------------------------------------------------------------

    grunt.option.init();
	grunt.registerTask('default',   						['ts:Index', 'uglify', 'watch' ]);
};

